# ZAP Pentest Automation â€“ Kubernetes Quick Start

This guide explains how to run an automated ZAP penetration test job in Kubernetes, and how to view the results via a web-based report viewer.

---

## Prerequisites

- Your ZAP configuration, scripts, and collections should be present on your local machine in `D:\DEV\ZAP` as follows:
    - `D:\DEV\ZAP\config\automation.yaml`
    - `D:\DEV\ZAP\postman\postman-collection.json`
    - `D:\DEV\ZAP\scripts\active\...`
    - `D:\DEV\ZAP\scripts\httpsender\...`
- Your custom ZAP Docker image (e.g., `stefangolubov/zap-custom:latest`) is built and pushed to a registry accessible by your Kubernetes cluster.

- In order the generated reports to be easily accessible, an Nginx server is preconfigured that serves the reports written to the reports-pvc (on default namespace).

---

## 1. Run the ZAP Pentest Job

This will mount your ZAP configs/scripts from your host, run the pentest, and write the reports into the shared PVC.

```sh
kubectl apply -f zap-pentest-job.yaml
```

You can monitor the job with:

```sh
kubectl get pods -w
kubectl logs -f <zap-pentest-job-pod-name>
```

---

## 2. View the Test Reports

After the ZAP job completes, reports will appear in the `/zap` directory served by the report viewer.

- Open: `http://<your-node-ip>:30080/zap/`
    - Find the most recent `.html` or `.json` files (`tmmj-pen-test-<timestamp>.html`, etc.)

---

## 3. (Optional) Cleanup

To remove test resources:

```sh
kubectl delete job zap-pentest-job

```

---

## Notes

- If you update your ZAP scripts/configs, re-run the pentest job.
- If you need to mount the ZAP files from a different path, update the `zap-pentest-job.yaml` volume definition.
- You can run multiple pentest jobs; each will write a timestamped report to the shared PVC, visible in the report viewer.

---